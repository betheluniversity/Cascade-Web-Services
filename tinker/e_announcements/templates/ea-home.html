{% extends "tinker_base.html" %}

{% set title = 'E-Announcements' %}

{% block styles %}
    <style type="text/css">
    </style>
{% endblock %}

{% block page_title %}Bethel University Tinker{% endblock %}

{% block main_content %}
    <div class="content">
        <div class="container-fluid">
            <div class="col-md-12">
                <p class="description">Below is the list of E-Announcements you have access to edit.
                </p>
                <p class="description"> The below are optional parameters to help in your search.</p>
                <div>
                    <small>Used by entering in part of a name, for example "scho" will select E-Announcements with
                        words "scholar", "school", "scholastic" etc.</small>
                    <label for="annzTitle">E-Announcement Title:</label>
                        <input id="annzTitle" type="text" name="annzTitle"><br/>
                    <small>The Start and End fields are to specify the date range where an announcment might fall,
                        for example "New Years Eve" and "Christmas" would both show up if you started at December 25th
                        and ended on December 31st</small>
                    <label for="annzStart">Start Date:</label>
                        <input id="annzStart" class='datepicker' size='11'/>
                    <label for="annzEnd">End Date:</label>
                        <input id="annzEnd" class='datepicker' size='11'/>
                    <a type="submit" id="event-submit-btn" class="btn btn-primary search-events">Search</a>
                </div>
                {# spinner placeholder #}
                <div id="spinner" class="spinner" style="display:none;">
                    <img id="img-spinner" src="https://cdn1.bethel.edu/images/load.gif" alt="Loading"/>
                </div>
                <hr/>
                <a href="{{ url_for('e_announcements.EAnnouncementsView:new') }}" class="btn btn-primary new-btn">Submit
                    New E-Announcement</a>
            </div>
        </div>
    </div>


{% endblock %}

{% block modalhtml %}
<!-- Modal Core -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Are you sure you want to delete?</h4>
            </div>
            <div class="modal-body">
                Your E-Announcement will be removed.
            </div>
            <div class="modal-footer">
                <a id="modal-confirm" href="/e-announcements/delete/formid" type="button"
                   class="btn btn-primary btn-alert modal-confirm">Delete</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    {#  Script to do Bethel E-Announcements fancyness for blacking out dates to pick  #}
    <script type="text/javascript" src="E-Announcements-pikaday.js"></script>
    {#  Script to update the modal submit to delete the correct form#}
    <script type="text/javascript">
        $(".delete-press").click(function () {
            $("#modal-confirm").attr("href", "/e-announcements/delete/" + $(this).data('e-announcement-id'));
        });
        function search_announcements() {
            search_url = "{{ url_for('e_announcements.EAnnouncementsView:search') }}";
            $('#spinner').show();
            inputs = {
                "title": $("#annzTitle").val(),
                "start": $("#annzStart").val(),
                "end": $("#annzEnd").val(),
{#                Add in the school selector with the drop down later on when everything is working#}
{#                "selection": $("#school-selector").val()#}
            };
            $.ajax({
                type: "POST",
                url: search_url,
                data: JSON.stringify(inputs),
                contentType: 'application/json;charset=UTF-8',
                success: function (result) {
                    // window.location.replace(result);
                    document.getElementById('results').innerHTML = result;
                    $('#spinner').hide();
                }
            });
        }
        $(".search-announcements").click(function () {
            search_announcements();
        });
        search_announcements();
    </script>

{% endblock %}


